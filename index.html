<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASTARK SpeedBot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0e0e23;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1a1a3d;
      padding: 15px;
      font-size: 1.5em;
      font-weight: bold;
      color: #4fc3f7;
    }
    main {
      padding: 20px;
    }
    input, select, button {
      padding: 10px;
      margin: 8px;
      border-radius: 5px;
      border: none;
      font-size: 1em;
    }
    input, select {
      width: 250px;
    }
    button {
      cursor: pointer;
      background: #4fc3f7;
      color: #000;
      font-weight: bold;
    }
    button:hover {
      background: #0288d1;
      color: #fff;
    }
    .log {
      margin-top: 20px;
      text-align: left;
      max-height: 300px;
      overflow-y: auto;
      background: #111;
      padding: 10px;
      border-radius: 5px;
      font-size: 0.9em;
    }
    .prediction {
      margin-top: 15px;
      font-size: 1.2em;
      color: #ffeb3b;
    }
  </style>
</head>
<body>
  <header>‚ö° ASTARK SpeedBot ‚ö°</header>
  <main>
    <div>
      <input id="token" type="password" placeholder="Enter Deriv API Token" />
    </div>
    <div>
      <select id="market">
        <option value="R_10">Volatility 10 Index</option>
        <option value="R_25">Volatility 25 Index</option>
        <option value="R_50">Volatility 50 Index</option>
        <option value="R_75">Volatility 75 Index</option>
        <option value="R_100">Volatility 100 Index</option>
      </select>
    </div>
    <div>
      <input id="stake" type="number" placeholder="Stake amount" value="1" />
    </div>
    <div>
      <button id="start">‚ñ∂Ô∏è Start Bot</button>
      <button id="stop">‚èπÔ∏è Stop Bot</button>
    </div>
    <div class="prediction" id="prediction">Next Digit Prediction: -</div>
    <div class="log" id="log"></div>
  </main>

  <script>
    let ws;
    let running = false;

    const logBox = document.getElementById("log");
    const predictionBox = document.getElementById("prediction");

    function log(msg) {
      const time = new Date().toLocaleTimeString();
      logBox.innerHTML = `[${time}] ${msg}<br>` + logBox.innerHTML;
    }

    function connect() {
      ws = new WebSocket("wss://ws.binaryws.com/websockets/v3?app_id=1089");

      ws.onopen = () => log("‚úÖ Connected to Deriv API");

      ws.onmessage = (msg) => {
        const data = JSON.parse(msg.data);

        if (data.tick) {
          const lastDigit = parseInt(data.tick.quote.toString().slice(-1));
          const predDigit = (lastDigit + 1) % 10;
          predictionBox.innerText = `Next Digit Prediction: ${predDigit}`;

          if (running) {
            placeTrade(predDigit);
          }
        }
      };

      ws.onclose = () => log("‚ùå Connection closed");
    }

    function authorize(token) {
      ws.send(JSON.stringify({ authorize: token }));
    }

    function subscribeTicks(symbol) {
      ws.send(JSON.stringify({ ticks: symbol }));
    }

    function placeTrade(digit) {
      const stake = document.getElementById("stake").value;
      const market = document.getElementById("market").value;

      const contract = {
        buy: 1,
        parameters: {
          amount: stake,
          basis: "stake",
          contract_type: "DIGITMATCH",
          currency: "USD",
          duration: 1,
          duration_unit: "t",
          symbol: market,
          barrier: digit.toString()
        }
      };

      ws.send(JSON.stringify(contract));
      log(`üìä Trade placed on ${market}, predicting digit: ${digit}`);
    }

    document.getElementById("start").onclick = () => {
      const token = document.getElementById("token").value;
      if (!token) return alert("Please enter your Deriv API token");

      connect();
      setTimeout(() => {
        authorize(token);
        const market = document.getElementById("market").value;
        subscribeTicks(market);
        running = true;
        log("üöÄ Bot started");
      }, 1000);
    };

    document.getElementById("stop").onclick = () => {
      running = false;
      if (ws) ws.close();
      log("üõë Bot stopped");
    };
  </script>
</body>
</html>
